# ACNH-Pattern-Research
Research on Animal Crossing: New Horizons design pattern data for fixing some save editor bugs.  
~~This is in reference to fork: https://github.com/lottehime/NHSE~~  
Results were submitted to NHSE master and merged! ðŸ¥³


### What is it?
I noticed when using NHSE and ACNHDesignPatternEditor that under certain conditions, importing pattern files (`*.nhd` or `*.acnh`) did not seem to set the patterns as owned by the player and thus they were not editable in-game, much like if they were QR codes or from the pattern exchange.

I also noticed that for some pattern slots, the previous pattern name would remain in place of the imported one.

It bugged me.

So, I hacked together a fix and added it to a fork of NHSE which [you can find here](https://github.com/lottehime/NHSE) (source only).  
Current builds of [NHSE from the main website](https://berichan.github.io/GetNHSE/) now have this research implemented!  
Builds removed from this repo now. ðŸ‘  
~~I also added a build to this repo while waiting for the pull request to resolve, so that you (and I) can use it without waiting.~~  



## Research
Design pattern data is found in `main.dat` within the save, as are flags for if the player has edited the pattern slot.  
An ID for the player and the town/island reside in `personal.dat` within the save.

The pattern 'IsEdited' flags begin at offset `0x8BE260` starting with design 1 of 100. Each flag is a single byte and each byte begins as `0xFF` and is changed to `0x00` when the player edits that pattern slot.  
Add `0x64` to that offset to get to the design PRO patterns at offset `0x8BE2C4` starting with design 1 of 100. The bytes follow the same pattern as above.  
This fixes the issue of imported patterns retaining the name of the pattern originally in that slot.

The issue of pattern ownership and editability is caused by the pattern data not being written to `main.dat` with the players IDs correctly, as well as what appears to be a flag value that needs to be reset.  
The players ID information can be found within `personal.dat` starting at offset `0xB0B8`. It can also be found in other locations, such as `main.dat` before the pattern offsets.  
It is made up of two primary parts: the `PlayerID` and `TownID`, which are each made up of two parts; the `ID` and the `Name`.

The TownID comes first, with the ID starting at offset `0xB0B8` for 4 bytes, followed by the name starting at `0xB0BC` for 20 bytes.  
The 20 bytes represent the name as a 10 character long name with `0x00` between each character.

The PlayerID comes next, with the ID starting at offset `0xB0D4` for 4 bytes, followed by the name starting at `0xB0D8` for 20 bytes.  
The 20 bytes represent the name as a 10 character long name with `0x00` between each character.

Storing these as a two byte arrays of `0x18` or 24 bytes length starting at each of their respective offsets allows us to then write them into the data for the patterns as we insert them into `main.dat`.

The flag value that follows them appears to be 4 bytes long and replacing each byte with `0x00` seems to modify ownership so long as the above ID values match what the game expects correctly.

Patterns in `main.dat` start at offset `0x1E3968` and flow into one another.  
Complete untrimmed pattern data is 680 bytes long, starting with a 16 byte hash and ending with 3 trailing `0x00` bytes after the image data.  
This format matches what you will find in `*.acnh` files from https://acpatterns.com/ and `*.nhd` files from NHSE, files from other editors may be trimmed.  
We can use a `*.nhd` file to isolate the data we are interested in.

The structure of the pattern file is roughly as follows:  

### ACNH Design Pattern Data:
`0x000 -> 0x00F`: pattern hash - (16 bytes long)  
`0x010 -> 0x037`: pattern name - (40 bytes long, 20 char name with separating `0x00`)  
`0x038 -> 0x03B`: town ID - (4 bytes long)  
`0x03C -> 0x04F`: town name - (20 bytes long, 10 char name with separating `0x00`)  
`0x050 -> 0x053`: padding? - (4 bytes long)  
`0x054 -> 0x057`: player ID - (4 bytes long)  
`0x058 -> 0x06B`: player name - (20 bytes long, 10 char name with separating `0x00`)  
`0x06C -> 0x06F`: padding? - (4 bytes long)  
`0x070 -> 0x073`: ownership flag? - (4 bytes long)  
`0x074 -> 0x076`: padding? - (3 bytes long)  
`0x077 -> 0x077`: pattern type - (1 byte long, see below)  
`0x078 -> 0x0A4`: palette data - (45 bytes long, 15*3, 15 colors 3 bytes each (rgb))  
`0x0A5 -> 0x2A4`: pixel data - (512 bytes long, pro designs except this, see below)  
`0x2A5 -> 0x2A7`: trailing padding - (3 bytes long)  

<details>
  <summary>Pattern Type Values:</summary>
  
`0x00`: Simple Pattern  
`0x01`: Empty Pro Pattern  
`0x02`: Simple Shirt  
`0x03`: Long Sleeve Shirt  
`0x04`: T Shirt  
`0x05`: Tanktop  
`0x06`: Pullover  
`0x07`: Hoodie  
`0x08`: Coat  
`0x09`: Short Sleeve Dress  
`0x0A`: Sleeveless Dress  
`0x0B`: Long Sleeve Dress  
`0x0C`: Balloon Dress  
`0x0D`: Round Dress  
`0x0E`: Robe  
`0x0F`: Brimmed Cap  
`0x10`: Knit Cap  
`0x11`: Brimmed Hat  
`0x12`: Short Sleeve Dress 3DS (ACNL Support)  
`0x13`: Long Sleeve Dress 3DS (ACNL Support)  
`0x14`: Sleeveless Dress 3DS (ACNL Support)  
`0x15`: Short Sleeve Shirt 3DS (ACNL Support)  
`0x16`: Long Sleeve Shirt3DS (ACNL Support)  
`0x17`: Sleeveless Shirt 3DS (ACNL Support)  
`0x18`: Hat 3DS (ACNL Support)  
`0x19`: Horn Hat 3DS (ACNL Support)  
`0x1E`: Standee 3DS (ACNL Support)  
`0x1A`: Standee  
`0x1B`: Umbrella  
`0x1C`: Flag  
`0x1D`: Fan  
`0xFF`: Unsupported  

</details>

<details>
  <summary>PRO Design Pattern Exception:</summary>

For PRO Design Patterns, the pixel data is longer and is followed by the same termination padding.  
See below:  
`0x0A5 -> 0x8A4`: pixel data - (2048 bytes long)  
`0x8A5 -> 0x8A7`: trailing padding - (3 bytes long)  

</details>

### ACNL Interoperability
Due to the QR code import in ACNH that supports ACNL designs, interoperability is fairly straight forward.  
The ACNL design pattern data format shares similarities with the ACNH format in that it contains name strings, ID bytes, hashes, pattern type bytes, a color palette and pixel data.

To convert the data between, you simply need to adjust values as required and move the data to the correct offsets.  
The structure is per below:

<details>
  <summary>ACNL Pattern Data:</summary>

`0x000 -> 0x029`: pattern name (42 bytes long, 20 char name with separating `0x00` with terminating dual `0x00`)  
`0x02A -> 0x02B`: user ID (2 bytes long)  
`0x02C -> 0x03F`: user name (20 bytes long, 9 char name with separating `0x00` and a terminating `0x01`)  
`0x040 -> 0x041`: town id (2 bytes long)  
`0x042 -> 0x055`: town name (20 bytes long, 9 char name with separating `0x00` and a terminating `0x01`)  
`0x056 -> 0x057`: unknown flag? (2 bytes long, values seem random)  
`0x058 -> 0x066`: palette data (15 bytes long, value is an index lookup, see below)  
`0x067 -> 0x067`: unknown flag? (1 byte long, value seems random)  
`0x068 -> 0x068`: ownership flag? (1 byte long, appeats to be `0x00` or `0x0A` only)  
`0x069 -> 0x069`: pattern type (1 byte long, see below)  
`0x06A -> 0x 6B`: padding (2 bytes long)  
`0x06C -> 0x26B`: pixel data main (512 bytes long, main pixels)  
`0x26C -> 0x46B`: pixel data expanded 1 (512 bytes long, extra pro pattern pixels)  
`0x46C -> 0x66B`: pixel data expanded 2 (512 bytes long, extra pro pattern pixels)  
`0x66C -> 0x86B`: pixel data expanded 3 (512 bytes long, extra pro pattern pixels)  
`0x86C -> 0x86F`: trailing padding (4 bytes long, appears optional)  

</details>

For strings (names), either trim or expand them to match the format (ACNL -> ACNH expand, ACNH -> ACNL trim).  
The same can be said for the ID bytes.

Pattern types are cross supported (ACNH has pattern types for the ACNL patterns). Simply match up the type value correctly from each index.

<details>
  <summary>ACNL Pattern Types Values:</summary>

`0x00`: Long Sleeve Dress (Pro)  
`0x01`: Short Sleeve Dress (Pro)  
`0x02`: Sleeveless Dress (Pro)  
`0x03`: Long Sleeve Shirt (Pro)  
`0x04`: Short Sleeve Shirt (Pro)  
`0x07`: Plain Pattern (Hat)  
`0x08`: Standee (Pro)  
`0x09`: Simple Pattern (Easel)  

</details>

The color palette for ACNL is comprised of 159 fixed colors with an index to be looked up, unlike ACNH which supports a wide selection of RGBA colors.  
To convert from ACNH to ACNL format a closest matching color function needs to be run against the ACNH color to find the closest one in the ACNL index for each of the 15 colors. The color is then represented in the palette as that single index byte instead of the 3 bytes for RGB used by ACNH.  
To convert in the other direction, a straight conversion can be made by taking the index and it's known color value and writing out the three values.

<details>
  <summary>ACNL Color Palette Index:</summary>

`0x00`: color.RGBA { 0xFF, 0xEE, 0xFF, 0xFF} //Pink (0x00 - 0x08)  
`0x01`: color.RGBA { 0xFF, 0x99, 0xAA, 0xFF}  
`0x02`: color.RGBA { 0xEE, 0x55, 0x99, 0xFF}  
`0x03`: color.RGBA { 0xFF, 0x66, 0xAA, 0xFF}  
`0x04`: color.RGBA { 0xFF, 0x00, 0x66, 0xFF}  
`0x05`: color.RGBA { 0xBB, 0x44, 0x77, 0xFF}  
`0x06`: color.RGBA { 0xCC, 0x00, 0x55, 0xFF}  
`0x07`: color.RGBA { 0x99, 0x00, 0x33, 0xFF}  
`0x08`: color.RGBA { 0x55, 0x22, 0x33, 0xFF}  
`0x09`: color.empty,  
`0x0A`: color.empty,  
`0x0B`: color.empty,  
`0x0C`: color.empty,  
`0x0D`: color.empty,  
`0x0E`: color.empty,  
`0x0F`: color.RGBA { 0xFF, 0xFF, 0xFF, 0xFF} //0x0F: Grey 1 (White)  
`0x10`: color.RGBA { 0xFF, 0xBB, 0xCC, 0xFF} //Red (0x10 - 0x18)  
`0x11`: color.RGBA { 0xFF, 0x77, 0x77, 0xFF}  
`0x12`: color.RGBA { 0xDD, 0x32, 0x10, 0xFF}  
`0x13`: color.RGBA { 0xFF, 0x55, 0x44, 0xFF}  
`0x14`: color.RGBA { 0xFF, 0x00, 0x00, 0xFF}  
`0x15`: color.RGBA { 0xCC, 0x66, 0x66, 0xFF}  
`0x16`: color.RGBA { 0xBB, 0x44, 0x44, 0xFF}  
`0x17`: color.RGBA { 0xBB, 0x00, 0x00, 0xFF}  
`0x18`: color.RGBA { 0x88, 0x22, 0x22, 0xFF}  
`0x19`: color.empty,  
`0x1A`: color.empty,  
`0x1B`: color.empty,  
`0x1C`: color.empty,  
`0x1D`: color.empty,  
`0x1E`: color.empty,  
`0x1F`: color.RGBA { 0xEE, 0xEE, 0xEE, 0xFF} //0x1F: Grey 2  
`0x20`: color.RGBA { 0xDD, 0xCD, 0xBB, 0xFF} //Orange (0x20 - 0x28)  
`0x21`: color.RGBA { 0xFF, 0xCD, 0x66, 0xFF}  
`0x22`: color.RGBA { 0xDD, 0x66, 0x22, 0xFF}  
`0x23`: color.RGBA { 0xFF, 0xAA, 0x22, 0xFF}  
`0x24`: color.RGBA { 0xFF, 0x66, 0x00, 0xFF}  
`0x25`: color.RGBA { 0xBB, 0x88, 0x55, 0xFF}  
`0x26`: color.RGBA { 0xDD, 0x44, 0x00, 0xFF}  
`0x27`: color.RGBA { 0xBB, 0x44, 0x00, 0xFF}  
`0x28`: color.RGBA { 0x66, 0x32, 0x10, 0xFF}  
`0x29`: color.empty,  
`0x2A`: color.empty,  
`0x2B`: color.empty,  
`0x2C`: color.empty,  
`0x2D`: color.empty,  
`0x2E`: color.empty,  
`0x2F`: color.RGBA { 0xDD, 0xDD, 0xDD, 0xFF} //0x2F: Grey 3  
`0x30`: color.RGBA { 0xFF, 0xEE, 0xDD, 0xFF} //Peach (0x30 - 0x38)  
`0x31`: color.RGBA { 0xFF, 0xDD, 0xCC, 0xFF}  
`0x32`: color.RGBA { 0xFF, 0xCD, 0xAA, 0xFF}  
`0x33`: color.RGBA { 0xFF, 0xBB, 0x88, 0xFF}  
`0x34`: color.RGBA { 0xFF, 0xAA, 0x88, 0xFF}  
`0x35`: color.RGBA { 0xDD, 0x88, 0x66, 0xFF}  
`0x36`: color.RGBA { 0xBB, 0x66, 0x44, 0xFF}  
`0x37`: color.RGBA { 0x99, 0x55, 0x33, 0xFF}  
`0x38`: color.RGBA { 0x88, 0x44, 0x22, 0xFF}  
`0x39`: color.empty,  
`0x3A`: color.empty,  
`0x3B`: color.empty,  
`0x3C`: color.empty,  
`0x3D`: color.empty,  
`0x3E`: color.empty,  
`0x3F`: color.RGBA { 0xCC, 0xCD, 0xCC, 0xFF} //0x3F: Grey 4  
`0x40`: color.RGBA { 0xFF, 0xCD, 0xFF, 0xFF} //Purple (0x40 - 0x48)  
`0x41`: color.RGBA { 0xEE, 0x88, 0xFF, 0xFF}  
`0x42`: color.RGBA { 0xCC, 0x66, 0xDD, 0xFF}  
`0x43`: color.RGBA { 0xBB, 0x88, 0xCC, 0xFF}  
`0x44`: color.RGBA { 0xCC, 0x00, 0xFF, 0xFF}  
`0x45`: color.RGBA { 0x99, 0x66, 0x99, 0xFF}  
`0x46`: color.RGBA { 0x88, 0x00, 0xAA, 0xFF}  
`0x47`: color.RGBA { 0x55, 0x00, 0x77, 0xFF}  
`0x48`: color.RGBA { 0x33, 0x00, 0x44, 0xFF}  
`0x49`: color.empty,  
`0x4A`: color.empty,  
`0x4B`: color.empty,  
`0x4C`: color.empty,  
`0x4D`: color.empty,  
`0x4E`: color.empty,  
`0x4F`: color.RGBA { 0xBB, 0xBB, 0xBB, 0xFF} //0x4F: Grey 5  
`0x50`: color.RGBA { 0xFF, 0xBB, 0xFF, 0xFF} //Fuchsia (0x50 - 0x58)  
`0x51`: color.RGBA { 0xFF, 0x99, 0xFF, 0xFF}  
`0x52`: color.RGBA { 0xDD, 0x22, 0xBB, 0xFF}  
`0x53`: color.RGBA { 0xFF, 0x55, 0xEE, 0xFF}  
`0x54`: color.RGBA { 0xFF, 0x00, 0xCC, 0xFF}  
`0x55`: color.RGBA { 0x88, 0x55, 0x77, 0xFF}  
`0x56`: color.RGBA { 0xBB, 0x00, 0x99, 0xFF}  
`0x57`: color.RGBA { 0x88, 0x00, 0x66, 0xFF}  
`0x58`: color.RGBA { 0x55, 0x00, 0x44, 0xFF}  
`0x59`: color.empty,  
`0x5A`: color.empty,  
`0x5B`: color.empty,  
`0x5C`: color.empty,  
`0x5D`: color.empty,  
`0x5E`: color.empty,  
`0x5F`: color.RGBA { 0xAA, 0xAA, 0xAA, 0xFF} //0x5F: Grey 6  
`0x60`: color.RGBA { 0xDD, 0xBB, 0x99, 0xFF} //Brown (0x60 - 0x68)  
`0x61`: color.RGBA { 0xCC, 0xAA, 0x77, 0xFF}  
`0x62`: color.RGBA { 0x77, 0x44, 0x33, 0xFF}  
`0x63`: color.RGBA { 0xAA, 0x77, 0x44, 0xFF}  
`0x64`: color.RGBA { 0x99, 0x32, 0x00, 0xFF}  
`0x65`: color.RGBA { 0x77, 0x32, 0x22, 0xFF}  
`0x66`: color.RGBA { 0x55, 0x22, 0x00, 0xFF}  
`0x67`: color.RGBA { 0x33, 0x10, 0x00, 0xFF}  
`0x68`: color.RGBA { 0x22, 0x10, 0x00, 0xFF}  
`0x69`: color.empty,  
`0x6A`: color.empty,  
`0x6B`: color.empty,  
`0x6C`: color.empty,  
`0x6D`: color.empty,  
`0x6E`: color.empty,  
`0x6F`: color.RGBA { 0x99, 0x99, 0x99, 0xFF} //0x6F: Grey 7  
`0x70`: color.RGBA { 0xFF, 0xFF, 0xCC, 0xFF} //Yellow (0x70 - 0x78)  
`0x71`: color.RGBA { 0xFF, 0xFF, 0x77, 0xFF}  
`0x72`: color.RGBA { 0xDD, 0xDD, 0x22, 0xFF}  
`0x73`: color.RGBA { 0xFF, 0xFF, 0x00, 0xFF}  
`0x74`: color.RGBA { 0xFF, 0xDD, 0x00, 0xFF}  
`0x75`: color.RGBA { 0xCC, 0xAA, 0x00, 0xFF}  
`0x76`: color.RGBA { 0x99, 0x99, 0x00, 0xFF}  
`0x77`: color.RGBA { 0x88, 0x77, 0x00, 0xFF}  
`0x78`: color.RGBA { 0x55, 0x55, 0x00, 0xFF}  
`0x79`: color.empty,  
`0x7A`: color.empty,  
`0x7B`: color.empty,  
`0x7C`: color.empty,  
`0x7D`: color.empty,  
`0x7E`: color.empty,  
`0x7F`: color.RGBA { 0x88, 0x88, 0x88, 0xFF} //0x7F: Grey 8  
`0x80`: color.RGBA { 0xDD, 0xBB, 0xFF, 0xFF} //Indigo (0x80 - 0x88)  
`0x81`: color.RGBA { 0xBB, 0x99, 0xEE, 0xFF}  
`0x82`: color.RGBA { 0x66, 0x32, 0xCC, 0xFF}  
`0x83`: color.RGBA { 0x99, 0x55, 0xFF, 0xFF}  
`0x84`: color.RGBA { 0x66, 0x00, 0xFF, 0xFF}  
`0x85`: color.RGBA { 0x55, 0x44, 0x88, 0xFF}  
`0x86`: color.RGBA { 0x44, 0x00, 0x99, 0xFF}  
`0x87`: color.RGBA { 0x22, 0x00, 0x66, 0xFF}  
`0x88`: color.RGBA { 0x22, 0x10, 0x33, 0xFF}  
`0x89`: color.empty,  
`0x8A`: color.empty,  
`0x8B`: color.empty,  
`0x8C`: color.empty,  
`0x8D`: color.empty,  
`0x8E`: color.empty,  
`0x8F`: color.RGBA { 0x77, 0x77, 0x77, 0xFF} //0x8F: Grey 9  
`0x90`: color.RGBA { 0xBB, 0xBB, 0xFF, 0xFF} //Blue (0x90 - 0x98)  
`0x91`: color.RGBA { 0x88, 0x99, 0xFF, 0xFF}  
`0x92`: color.RGBA { 0x33, 0x32, 0xAA, 0xFF}  
`0x93`: color.RGBA { 0x33, 0x55, 0xEE, 0xFF}  
`0x94`: color.RGBA { 0x00, 0x00, 0xFF, 0xFF}  
`0x95`: color.RGBA { 0x33, 0x32, 0x88, 0xFF}  
`0x96`: color.RGBA { 0x00, 0x00, 0xAA, 0xFF}  
`0x97`: color.RGBA { 0x10, 0x10, 0x66, 0xFF}  
`0x98`: color.RGBA { 0x00, 0x00, 0x22, 0xFF}  
`0x99`: color.empty,  
`0x9A`: color.empty,  
`0x9B`: color.empty,  
`0x9C`: color.empty,  
`0x9D`: color.empty,  
`0x9E`: color.empty,  
`0x9F`: color.RGBA { 0x66, 0x66, 0x66, 0xFF} //0x9F: Grey 10  
`0xA0`: color.RGBA { 0x99, 0xEE, 0xBB, 0xFF} //Dark Green (0xA0 - 0xA8)  
`0xA1`: color.RGBA { 0x66, 0xCD, 0x77, 0xFF}  
`0xA2`: color.RGBA { 0x22, 0x66, 0x10, 0xFF}  
`0xA3`: color.RGBA { 0x44, 0xAA, 0x33, 0xFF}  
`0xA4`: color.RGBA { 0x00, 0x88, 0x33, 0xFF}  
`0xA5`: color.RGBA { 0x55, 0x77, 0x55, 0xFF}  
`0xA6`: color.RGBA { 0x22, 0x55, 0x00, 0xFF}  
`0xA7`: color.RGBA { 0x10, 0x32, 0x22, 0xFF}  
`0xA8`: color.RGBA { 0x00, 0x22, 0x10, 0xFF}  
`0xA9`: color.empty,  
`0xAA`: color.empty,  
`0xAB`: color.empty,  
`0xAC`: color.empty,  
`0xAD`: color.empty,  
`0xAE`: color.empty,  
`0xAF`: color.RGBA { 0x55, 0x55, 0x55, 0xFF} //0xAF: Grey 11  
`0xB0`: color.RGBA { 0xDD, 0xFF, 0xBB, 0xFF} //Light Green (0xB0 - 0xB8)  
`0xB1`: color.RGBA { 0xCC, 0xFF, 0x88, 0xFF}  
`0xB2`: color.RGBA { 0x88, 0xAA, 0x55, 0xFF}  
`0xB3`: color.RGBA { 0xAA, 0xDD, 0x88, 0xFF}  
`0xB4`: color.RGBA { 0x88, 0xFF, 0x00, 0xFF}  
`0xB5`: color.RGBA { 0xAA, 0xBB, 0x99, 0xFF}  
`0xB6`: color.RGBA { 0x66, 0xBB, 0x00, 0xFF}  
`0xB7`: color.RGBA { 0x55, 0x99, 0x00, 0xFF}  
`0xB8`: color.RGBA { 0x33, 0x66, 0x00, 0xFF}  
`0xB9`: color.empty,  
`0xBA`: color.empty,  
`0xBB`: color.empty,  
`0xBC`: color.empty,  
`0xBD`: color.empty,  
`0xBE`: color.empty,  
`0xBF`: color.RGBA { 0x44, 0x44, 0x44, 0xFF} //0xBF: Grey 12  
`0xC0`: color.RGBA { 0xBB, 0xDD, 0xFF, 0xFF} //Slate Blue (0xC0 - 0xC8)  
`0xC1`: color.RGBA { 0x77, 0xCD, 0xFF, 0xFF}  
`0xC2`: color.RGBA { 0x33, 0x55, 0x99, 0xFF}  
`0xC3`: color.RGBA { 0x66, 0x99, 0xFF, 0xFF}  
`0xC4`: color.RGBA { 0x10, 0x77, 0xFF, 0xFF}  
`0xC5`: color.RGBA { 0x44, 0x77, 0xAA, 0xFF}  
`0xC6`: color.RGBA { 0x22, 0x44, 0x77, 0xFF}  
`0xC7`: color.RGBA { 0x00, 0x22, 0x77, 0xFF}  
`0xC8`: color.RGBA { 0x00, 0x10, 0x44, 0xFF}  
`0xC9`: color.empty,  
`0xCA`: color.empty,  
`0xCB`: color.empty,  
`0xCC`: color.empty,  
`0xCD`: color.empty,  
`0xCE`: color.empty,  
`0xCF`: color.RGBA { 0x33, 0x32, 0x33, 0xFF} //0xCF: Grey 13  
`0xD0`: color.RGBA { 0xAA, 0xFF, 0xFF, 0xFF} //Light Blue (0xD0 - 0xD8)  
`0xD1`: color.RGBA { 0x55, 0xFF, 0xFF, 0xFF}  
`0xD2`: color.RGBA { 0x00, 0x88, 0xBB, 0xFF}  
`0xD3`: color.RGBA { 0x55, 0xBB, 0xCC, 0xFF}  
`0xD4`: color.RGBA { 0x00, 0xCD, 0xFF, 0xFF}  
`0xD5`: color.RGBA { 0x44, 0x99, 0xAA, 0xFF}  
`0xD6`: color.RGBA { 0x00, 0x66, 0x88, 0xFF}  
`0xD7`: color.RGBA { 0x00, 0x44, 0x55, 0xFF}  
`0xD8`: color.RGBA { 0x00, 0x22, 0x33, 0xFF}  
`0xD9`: color.empty,  
`0xDA`: color.empty,  
`0xDB`: color.empty,  
`0xDC`: color.empty,  
`0xDD`: color.empty,  
`0xDE`: color.empty,  
`0xDF`: color.RGBA { 0x22, 0x22, 0x22, 0xFF} //0xDF: Grey 14  
`0xE0`: color.RGBA { 0xCC, 0xFF, 0xEE, 0xFF} //Ocean Blue (0xE0 - 0xE8)  
`0xE1`: color.RGBA { 0xAA, 0xEE, 0xDD, 0xFF}  
`0xE2`: color.RGBA { 0x33, 0xCD, 0xAA, 0xFF}  
`0xE3`: color.RGBA { 0x55, 0xEE, 0xBB, 0xFF}  
`0xE4`: color.RGBA { 0x00, 0xFF, 0xCC, 0xFF}  
`0xE5`: color.RGBA { 0x77, 0xAA, 0xAA, 0xFF}  
`0xE6`: color.RGBA { 0x00, 0xAA, 0x99, 0xFF}  
`0xE7`: color.RGBA { 0x00, 0x88, 0x77, 0xFF}  
`0xE8`: color.RGBA { 0x00, 0x44, 0x33, 0xFF}  
`0xE9`: color.empty,  
`0xEA`: color.empty,  
`0xEB`: color.empty,  
`0xEC`: color.empty,  
`0xED`: color.empty,  
`0xEE`: color.empty,  
`0xEF`: color.RGBA { 0x00, 0x00, 0x00, 0xFF} //0xEF: Grey 15 (Black)  
`0xF0`: color.RGBA { 0xAA, 0xFF, 0xAA, 0xFF} //Bright Green (0xF0 - 0xF8)  
`0xF1`: color.RGBA { 0x77, 0xFF, 0x77, 0xFF}  
`0xF2`: color.RGBA { 0x66, 0xDD, 0x44, 0xFF}  
`0xF3`: color.RGBA { 0x00, 0xFF, 0x00, 0xFF}  
`0xF4`: color.RGBA { 0x22, 0xDD, 0x22, 0xFF}  
`0xF5`: color.RGBA { 0x55, 0xBB, 0x55, 0xFF}  
`0xF6`: color.RGBA { 0x00, 0xBB, 0x00, 0xFF}  
`0xF7`: color.RGBA { 0x00, 0x88, 0x00, 0xFF}  
`0xF8`: color.RGBA { 0x22, 0x44, 0x22, 0xFF}  
`0xF9`: color.empty,  
`0xFA`: color.empty,  
`0xFB`: color.empty,  
`0xFC`: color.empty,  
`0xFD`: color.empty,  
`0xFE`: color.empty,  
`0xFF`: color.empty  

</details>

### ACNH Design pattern Fix Conclusion:

If we take the `PlayerID` and `TownID` data extracted from `personal.dat` and inject it at offsets `0x54` and `0x38` respectively, then write these back to their correct location in `main.dat` (main pattern offset + index) we end up with a pattern written with the image we wanted, and the correct player and town IDs. Then we can overwrite the data at `0x70` with `0x00, 0x00, 0x00, 0x00`. This allows the user to own/edit them in-game.

When you mix the pattern being updated with the players IDs correctly, and the IsEdited flags flipped to edited you get a correctly named and editable pattern imported into your save. Yay!

PRO patterns follows a similar methodology, but with differing offsets. The above concept applied to them also works.  
You can refer to NHSE offsets in the source for more info.

This was fun to find and fix and I hope it is an educational reference in the future.

<!-- BUY ME A COFFEE -->
## Help Support More Like This

<a href="https://www.buymeacoffee.com/lottehime" target="_blank"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;" ></a>
